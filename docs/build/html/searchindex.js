Search.setIndex({"docnames": ["compilation", "data_structures", "examples", "index", "installation", "language_spec", "modules", "private_api", "public_api"], "filenames": ["compilation.rst", "data_structures.rst", "examples.rst", "index.rst", "installation.rst", "language_spec.rst", "modules.rst", "private_api.rst", "public_api.rst"], "titles": ["<strong>Compilation Process</strong>", "<strong>Data Structures</strong>", "<strong>Examples</strong>", "Welcome to MakkaPakka\u2019s documentation!", "<strong>Installation</strong>", "<strong>Language Features</strong>", "<strong>Modules</strong>", "<strong>Full API</strong>", "<strong>Public API</strong>"], "terms": {"blah": [0, 4, 8], "thi": [1, 3, 7, 8], "page": 1, "detail": 1, "us": [1, 3, 7, 8], "translat": [1, 3, 7], "makka": [1, 3, 7, 8], "pakka": [1, 3, 7, 8], "assembli": [1, 3, 7], "ar": [1, 7], "split": [1, 7, 8], "phase": [1, 7, 8], "compil": [1, 3, 7], "more": 1, "inform": 1, "about": 1, "can": [1, 7], "found": [1, 7, 8], "public": [1, 3, 7], "api": [1, 3], "class": [1, 7], "makka_pakka": [1, 7, 8], "parsing_structur": 1, "mkpkfunction": [1, 7], "name": [1, 7, 8], "str": [1, 7, 8], "argument": [1, 7], "list": [1, 7, 8], "content": 1, "A": [1, 7, 8], "strcture": 1, "encapsul": 1, "code": [1, 3, 7, 8], "function": [1, 3, 7, 8], "mkpkdata": [1, 7], "valu": [1, 7, 8], "int": [1, 7, 8], "type": [1, 7], "mkpkdatatyp": [1, 7], "constant": 1, "identifi": 1, "object": [1, 7, 8], "mkpkgadget": [1, 7], "memory_loc": 1, "rop": [1, 3, 7], "gadget": [1, 7], "mkpkmetadata": [1, 7], "label": [1, 7, 8], "metadata": [1, 7, 8], "mkpkir": [1, 7, 8], "an": [1, 7, 8], "intermedi": [1, 7, 8], "represent": [1, 7, 8], "program": [1, 3, 7], "languag": [1, 3], "popul": 1, "dure": [1, 7, 8], "mkpkline": [1, 7], "hold": 1, "raw": [1, 7], "text": 1, "line": [1, 7], "from": [1, 7, 8], "mkpk": [1, 7, 8], "respect": 1, "head": [1, 7, 8], "section": [1, 7], "processing_structur": 1, "mkpkcode": [1, 7, 8], "result": [1, 7, 8], "mkpkcyclicdepend": 1, "headlin": 1, "descript": 1, "alert": 1, "caller": 1, "when": [1, 3, 7], "cyclic": 1, "depend": [1, 7, 8], "i": [1, 3, 7, 8], "detect": [1, 7], "directedgraph": 1, "mkpkerror": 1, "which": [1, 3, 7, 8], "standardis": 1, "format": [1, 7, 8], "makkapakka": 1, "error": 1, "messga": 1, "mkpkintegratingerror": 1, "while": 1, "integr": [1, 3], "mkpkinvalidparamet": [1, 7], "func": [1, 7], "ani": [1, 7], "paramet": [1, 7, 8], "pass": [1, 7, 8], "invalid": [1, 7], "like": 1, "becaus": 1, "incorrect": 1, "mkpklinkingerror": 1, "link": [1, 3, 7, 8], "mkpknameerror": [1, 7], "mkpkparsingerror": [1, 7], "mkpkprocessingerror": [1, 7], "netwid": 3, "nasm": [3, 7], "It": [3, 7], "implement": 3, "addit": 3, "featur": 3, "top": [3, 7], "tradit": 3, "automat": 3, "replac": [3, 7], "The": [3, 7, 8], "wa": [3, 7, 8], "built": 3, "make": [3, 7], "easier": 3, "write": [3, 7, 8], "sit": 3, "cave": [3, 7, 8], "must": [3, 7], "posit": 3, "independ": 3, "therefor": [3, 7], "written": [3, 7, 8], "correctli": 3, "all": [3, 7, 8], "For": [3, 7], "instruct": 3, "how": [3, 7], "instal": 3, "check": [3, 7, 8], "out": 3, "project": [3, 7], "made": 3, "research": 3, "purpos": 3, "should": [3, 7], "malici": 3, "inject": [3, 7], "exampl": [3, 7], "process": 3, "data": [3, 7, 8], "structur": [3, 7], "pars": 3, "except": 3, "elf": 3, "caver": 3, "full": 3, "modul": 3, "index": [3, 7, 8], "search": 7, "defin": 7, "everi": 7, "either": 7, "privat": 7, "highli": 7, "recommend": 7, "document": 7, "instead": 7, "_convert_heading_name_to_typ": 7, "headingtyp": 7, "convert": 7, "string": 7, "its": 7, "associ": 7, "return": [7, 8], "none": 7, "_split_into_head": 7, "mkpk_filepath": [7, 8], "file": [7, 8], "filepath": [7, 8], "contain": 7, "parse_makka_pakka": [7, 8], "gener": [7, 8], "parse_head": 7, "_extract_args_from_funct": 7, "extract": 7, "arg": 7, "definin": 7, "definit": 7, "e": 7, "g": 7, "func_nam": 7, "ag": 7, "indic": 7, "_interpret_data_typ": 7, "tupl": [7, 8], "interpret": 7, "rais": 7, "couldn": 7, "t": 7, "parse_data": 7, "pack": 7, "sourc": [7, 8], "parse_funct": 7, "strcutur": 7, "parse_gadget": 7, "parse_metadata": 7, "detect_head": 7, "headingstyl": 7, "enum": 7, "style": 7, "heading_nam": 7, "single_head": 7, "double_head": 7, "expect": 7, "below": 7, "_assert_valid_mkpk_nam": 7, "assert": 7, "valid": [7, 8], "debug": 7, "detect_heading_in_lin": 7, "determin": 7, "where": 7, "no_head": 7, "linker": [7, 8], "_assert_no_conflict_in_data_label": 7, "lh": 7, "rh": 7, "conflict": [7, 8], "_assert_no_conflict_in_funct": 7, "_assert_no_conflict_in_gadget_address": 7, "memori": [7, 8], "locat": 7, "_combine_mkpkir": 7, "combin": 7, "one": [7, 8], "param": 7, "first": 7, "kept": 7, "second": 7, "lost": 7, "merge_mkpkir": [7, 8], "merg": [7, 8], "singl": [7, 8], "readi": [7, 8], "intend": [7, 8], "call": [7, 8], "parse_with_link": [7, 8], "respons": [7, 8], "sever": [7, 8], "do": [7, 8], "conflit": [7, 8], "ropgadget": [7, 8], "address": [7, 8], "parse_link_and_merg": [7, 8], "main": [7, 8], "pakkka": [7, 8], "recurs": [7, 8], "direct": [7, 8], "repres": [7, 8], "have": [7, 8], "been": [7, 8], "0": [7, 8], "remark": [7, 8], "each": [7, 8], "ir": [7, 8], "assign": [7, 8], "attribut": [7, 8], "link_depth": [7, 8], "specifi": [7, 8], "number": [7, 8], "between": [7, 8], "1": [7, 8], "linker_path": 7, "linkerpath": 7, "mkpk_main_filepath": 7, "store": 7, "path": [7, 8], "directori": 7, "find": [7, 8], "linkabl": 7, "add_path_to_link": 7, "dir_path": 7, "prioriti": 7, "prioritytyp": 7, "add": 7, "give": 7, "new": 7, "find_mkpk_fil": 7, "mkpk_filenam": 7, "iter": 7, "through": 7, "basenam": 7, "If": 7, "multipl": 7, "same": 7, "higher": 7, "select": 7, "resolv": 7, "absolut": 7, "filenam": 7, "process_makka_pakka": [7, 8], "run": [7, 8], "ha": [7, 8], "data_replac": 7, "_extract_data_refer": 7, "code_lin": 7, "mani": 7, "refer": 7, "were": 7, "_extract_label_from_refer": 7, "data_refer": 7, "appl": 7, "would": 7, "_replace_reference_with_valu": 7, "archiv": 7, "process_data_replac": 7, "correspond": 7, "num": 7, "my_func": 7, "mov": 7, "rax": 7, "Will": 7, "becom": 7, "function_replac": 7, "_assert_correct_num_of_arg": 7, "curr_func": 7, "passed_arg": 7, "mkpkargumentset": 7, "equal": 7, "_get_function_by_name_or_assert": 7, "get": [7, 8], "processingerror": 7, "_get_line_as_function_cal": 7, "mkpkfunctioncal": 7, "attempt": 7, "retrun": 7, "_get_ref_value_from_argu": 7, "": 7, "These": 7, "exist": 7, "_parse_line_as_function_cal": 7, "process_function_replac": 7, "func_1": 7, "2": 7, "arg1": 7, "ecx": 7, "execut": 7, "_format_code_into_asm_funct": 7, "_start": 7, "so": 7, "standalon": 7, "binari": [7, 8], "obj": 7, "_translate_mkpkdata_to_asm": 7, "_write_code_to_fil": 7, "output_filepath": [7, 8], "output": 7, "option": 7, "random": [7, 8], "tmp": [7, 8], "uuid": [7, 8], "integrate_makka_pakka": [7, 8], "elf_cav": [7, 8], "code_cav": [7, 8], "_get_end_of_sect": 7, "offset": [7, 8], "end": 7, "final": 7, "_get_end_of_seg": 7, "segment": 7, "_get_executable_seg": 7, "filter": 7, "just": 7, "those": 7, "flag": 7, "_get_last_section_in_seg": 7, "last": 7, "get_code_cav": [7, 8], "size": [7, 8], "file_permiss": 7, "is_execut": 7, "bool": 7, "true": 7, "permiss": 7, "integ": 7, "is_writ": 7, "writabl": 7, "permission_to_str": 7, "form": 7, "rw": 7, "rx": 7, "print_elf": 7, "pprint_head": 7, "print": 7, "header": 7, "stdout": 7, "readabl": 7, "pprint_sect": 7, "tabl": 7, "pprint_seg": 7, "table_formatt": 7, "print_tabl": 7, "column": 7, "kwarg": 7, "dict": 7, "pretti": 7, "order": 7, "length": 7, "align": 7, "desir": 7, "left": 7, "right": 7, "centr": 7, "lead": 7, "trail": 7, "space": 7, "appli": 7, "entri": 7, "befor": 7, "pad": 7, "blank": 7, "dynam": 7, "calcul": 7, "variad": 7, "two": 7, "table_rows_to_column": 7, "row": 7, "convieni": 7, "correct": 7, "injector": 7, "binary_injector": 7, "_get_shellcode_from_nasm": 7, "nasm_filepath": 7, "shellcod": 7, "byte": 7, "_inject_shellcode_at_offset": 7, "target_binari": 7, "given": 7, "patch": 7, "creat": 7, "inject_nasm_into_binari": 7, "target_binary_filepath": 7, "patch_entrypoint": 7, "whether": 7, "entrypoint": 7, "point": 7, "patch_exit": 7, "exit": 7, "throw": 7, "insufficientcodecav": 7, "There": 7, "larg": 7, "enough": 7, "target": 7, "malform": 7, "byte_extract": 7, "extract_byt": 7, "binary_filepath": 7, "hex": 7, "them": 7, "concaten": 7, "continu": 7, "12": 7, "34": 7, "56": 7, "to_little_endian_32bit": 7, "32": 7, "bit": 7, "littl": 7, "endian": 7, "arrai": 7, "target_arch": 7, "asm": 7, "architectur": 7, "redirect_execut": 7, "change_entrypoint": 7, "chang": 7, "elf64": 7, "patch_pltsec_exit": 7, "inject_offset": 7, "plt": 7, "sec": 7, "under": 7, "certain": 7, "condit": 7, "compli": 7, "pie": 7, "restrict": 7, "save": 7}, "objects": {"makka_pakka.elf_caver.caver": [[8, 0, 0, "-", "code_caver"], [7, 0, 0, "-", "file_permissions"]], "makka_pakka.elf_caver.caver.code_caver": [[7, 1, 1, "", "_get_end_of_section"], [7, 1, 1, "", "_get_end_of_segment"], [7, 1, 1, "", "_get_executable_segments"], [7, 1, 1, "", "_get_last_section_in_segment"], [8, 1, 1, "", "get_code_caves"]], "makka_pakka.elf_caver.caver.file_permissions": [[7, 1, 1, "", "is_executable"], [7, 1, 1, "", "is_writable"], [7, 1, 1, "", "permission_to_str"]], "makka_pakka.elf_caver.formatting": [[7, 0, 0, "-", "print_elf"], [7, 0, 0, "-", "table_formatter"]], "makka_pakka.elf_caver.formatting.print_elf": [[7, 1, 1, "", "pprint_header"], [7, 1, 1, "", "pprint_sections"], [7, 1, 1, "", "pprint_segments"]], "makka_pakka.elf_caver.formatting.table_formatter": [[7, 1, 1, "", "print_table"], [7, 1, 1, "", "table_rows_to_columns"]], "makka_pakka.elf_caver.injector": [[7, 0, 0, "-", "binary_injector"], [7, 0, 0, "-", "byte_extraction"], [7, 0, 0, "-", "compile"], [7, 0, 0, "-", "redirect_execution"]], "makka_pakka.elf_caver.injector.binary_injector": [[7, 1, 1, "", "_get_shellcode_from_nasm"], [7, 1, 1, "", "_inject_shellcode_at_offset"], [7, 1, 1, "", "inject_nasm_into_binary"]], "makka_pakka.elf_caver.injector.byte_extraction": [[7, 1, 1, "", "extract_bytes"], [7, 1, 1, "", "to_little_endian_32bit"]], "makka_pakka.elf_caver.injector.compile": [[7, 1, 1, "", "compile"]], "makka_pakka.elf_caver.injector.redirect_execution": [[7, 1, 1, "", "change_entrypoint"], [7, 1, 1, "", "patch_pltsec_exit"]], "makka_pakka.exceptions": [[1, 0, 0, "-", "exceptions"]], "makka_pakka.exceptions.exceptions": [[1, 2, 1, "", "MKPKCyclicDependency"], [1, 2, 1, "", "MKPKError"], [1, 2, 1, "", "MKPKIntegratingError"], [1, 2, 1, "", "MKPKInvalidParameter"], [1, 2, 1, "", "MKPKLinkingError"], [1, 2, 1, "", "MKPKNameError"], [1, 2, 1, "", "MKPKParsingError"], [1, 2, 1, "", "MKPKProcessingError"]], "makka_pakka.integrating": [[8, 0, 0, "-", "integrate"]], "makka_pakka.integrating.integrate": [[7, 1, 1, "", "_format_code_into_asm_function"], [7, 1, 1, "", "_translate_mkpkdata_to_asm"], [7, 1, 1, "", "_write_code_to_file"], [8, 1, 1, "", "integrate_makka_pakka"]], "makka_pakka.linking": [[8, 0, 0, "-", "linker"], [7, 0, 0, "-", "linker_path"]], "makka_pakka.linking.linker": [[7, 1, 1, "", "_assert_no_conflict_in_data_labels"], [7, 1, 1, "", "_assert_no_conflict_in_functions"], [7, 1, 1, "", "_assert_no_conflict_in_gadget_addresses"], [7, 1, 1, "", "_combine_MKPKIRs"], [8, 1, 1, "", "merge_MKPKIRs"], [8, 1, 1, "", "parse_link_and_merge"], [8, 1, 1, "", "parse_with_linking"]], "makka_pakka.linking.linker_path": [[7, 3, 1, "", "LinkerPath"]], "makka_pakka.linking.linker_path.LinkerPath": [[7, 4, 1, "", "add_path_to_linker"], [7, 4, 1, "", "find_mkpk_file"]], "makka_pakka.parsing": [[7, 0, 0, "-", "detect_headings"], [8, 0, 0, "-", "parse"], [7, 0, 0, "-", "parse_headings"]], "makka_pakka.parsing.detect_headings": [[7, 3, 1, "", "HeadingStyle"], [7, 3, 1, "", "HeadingType"], [7, 1, 1, "", "_assert_valid_mkpk_name"], [7, 1, 1, "", "detect_heading_in_line"]], "makka_pakka.parsing.parse": [[7, 1, 1, "", "_convert_heading_name_to_type"], [7, 1, 1, "", "_split_into_headings"], [8, 1, 1, "", "parse_makka_pakka"]], "makka_pakka.parsing.parse_headings": [[7, 1, 1, "", "_extract_args_from_function"], [7, 1, 1, "", "_interpret_data_type"], [7, 1, 1, "", "parse_data"], [7, 1, 1, "", "parse_functions"], [7, 1, 1, "", "parse_gadgets"], [7, 1, 1, "", "parse_metadata"]], "makka_pakka.parsing.parsing_structures": [[1, 3, 1, "", "MKPKData"], [1, 3, 1, "", "MKPKDataType"], [1, 3, 1, "", "MKPKFunction"], [1, 3, 1, "", "MKPKGadget"], [1, 3, 1, "", "MKPKIR"], [1, 3, 1, "", "MKPKLines"], [1, 3, 1, "", "MKPKMetaData"]], "makka_pakka.processing": [[7, 0, 0, "-", "data_replacement"], [7, 0, 0, "-", "function_replacement"], [8, 0, 0, "-", "process"], [1, 0, 0, "-", "processing_structures"]], "makka_pakka.processing.data_replacement": [[7, 1, 1, "", "_extract_data_references"], [7, 1, 1, "", "_extract_label_from_reference"], [7, 1, 1, "", "_replace_reference_with_value"], [7, 1, 1, "", "process_data_replacement"]], "makka_pakka.processing.function_replacement": [[7, 1, 1, "", "_assert_correct_num_of_args"], [7, 1, 1, "", "_get_function_by_name_or_assert"], [7, 1, 1, "", "_get_line_as_function_call"], [7, 1, 1, "", "_get_ref_value_from_arguments"], [7, 1, 1, "", "_parse_line_as_function_call"], [7, 1, 1, "", "process_function_replacement"]], "makka_pakka.processing.process": [[8, 1, 1, "", "process_makka_pakka"]], "makka_pakka.processing.processing_structures": [[1, 3, 1, "", "MKPKCode"]]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:exception", "3": "py:class", "4": "py:method"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "exception", "Python exception"], "3": ["py", "class", "Python class"], "4": ["py", "method", "Python method"]}, "titleterms": {"compil": [0, 8], "process": [0, 1, 7, 8], "data": 1, "structur": 1, "pars": [1, 7, 8], "except": 1, "exampl": 2, "welcom": 3, "makkapakka": 3, "": 3, "document": 3, "overview": 3, "indic": 3, "tabl": 3, "instal": 4, "languag": 5, "featur": 5, "modul": 6, "full": 7, "api": [7, 8], "integr": [7, 8], "elf": [7, 8], "caver": [7, 8], "public": 8}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 57}, "alltitles": {"Compilation Process": [[0, "compilation-process"]], "Data Structures": [[1, "data-structures"]], "Parsing Structures": [[1, "parsing-structures"]], "Processing Structures": [[1, "module-makka_pakka.processing.processing_structures"]], "Exceptions": [[1, "module-makka_pakka.exceptions.exceptions"]], "Examples": [[2, "examples"]], "Installation": [[4, "installation"], [4, "id1"]], "Language Features": [[5, "language-features"]], "Modules": [[6, "modules"]], "Full API": [[7, "full-api"]], "Parsing": [[7, "id1"], [8, "id2"]], "Processing": [[7, "id2"], [8, "id3"]], "Integrating": [[7, "id3"], [8, "id4"]], "ELF Caver": [[7, "id4"], [8, "id5"]], "Public API": [[8, "public-api"]], "Compilation process": [[8, "elf-caver"]], "Welcome to MakkaPakka\u2019s documentation!": [[3, "welcome-to-makkapakka-s-documentation"]], "Overview": [[3, "overview"]], "Indices and tables": [[3, "indices-and-tables"]]}, "indexentries": {}})
